import{a as U}from"./axios-DsPaXkF5.js";import{d as Z,a7 as ee,X as i,c as M,ai as m,a8 as v,ac as x,ab as l,j as o,aa as c,ao as s,S as V,ae as A,a9 as te,af as D,al as ae,am as oe}from"./index-Dc-7bNr1.js";import{c as ne,u as le}from"./checkAuth-DRjRzhnr.js";import{a as se,b as ie,_ as re,c as de}from"./ShowMsg-KA7jVWW1.js";import{A as ce}from"./ArrowLeftOutlined-C5b-G1zI.js";import{S as ue}from"./isPlainObject-CjZ0oXuE.js";import{F as pe,C as _e}from"./FilterOutlined-BGZYC0Kz.js";import{P as r}from"./PaperClipOutlined-92tKT1vU.js";import{M as me}from"./index-C_k8rEGL.js";import{_ as ve,a as be,I as fe,B as he}from"./index-B3D6LelG.js";import{e as ye}from"./index-CVi3Umml.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Col-DLOqwCl2.js";import"./responsiveObserve-32dtUrQu.js";import"./index-BltmkWy7.js";import"./Checkbox-CWfomWSa.js";const k=b=>(ae("data-v-d84bcfc8"),b=b(),oe(),b),ke={key:0},ge={class:"header-pg"},we=k(()=>l("div",{style:{"text-align":"center",width:"100%"}},"思路工具",-1)),Ie=k(()=>l("br",null,null,-1)),Ce={class:"content"},Se={class:"search_bar"},Me={style:{width:"80%","max-width":"1000px"}},Oe=k(()=>l("div",{style:{margin:"10px"}},null,-1)),Be={style:{"margin-bottom":"10px"}},Ke={key:0,class:"spin"},Te={key:1,class:"search_res"},Ue=["innerHTML"],Ve=k(()=>l("div",{style:{"margin-bottom":"100px"}},null,-1)),Ae=Z({__name:"Map",setup(b){ne();const{showMsgs:N,showMsgOpen:R,hilights:L,showIndex:$}=ee(le()),f=i(["1"]),O=i(["sub1","sub2","sub3","sub4","sub5"]),g=i(""),w=i(""),B=i("圣经经文"),K=i(0),h=i(!1),z=i([{key:"1",icon:()=>s(r),label:"圣经经文",title:"verse"},{key:"2",icon:()=>s(r),label:"圣经注解",title:"note"},{key:"3",icon:()=>s(r),label:"生命读经",title:"life"},{key:"sub1",icon:()=>s(r),label:"倪文集",title:"nee",children:[{key:"4",label:"倪文集书名",title:"nee_book"},{key:"5",label:"倪文集篇题",title:"nee_title"}]},{key:"sub2",icon:()=>s(r),label:"李文集",title:"lee",children:[{key:"6",label:"李文集书名",title:"lee_book"},{key:"7",label:"李文集篇题",title:"lee_title"}]},{key:"sub3",icon:()=>s(r),label:"其他",title:"other",children:[{key:"8",label:"新约总论书名",title:"other_book"},{key:"9",label:"新约总论篇题",title:"other_title"},{key:"10",label:"真理/生命课程、时代先见",title:"other_title"}]},{key:"sub4",icon:()=>s(r),label:"节期纲目",title:"feasts",children:[{key:"11",label:"节期纲目书名",title:"feasts_book"},{key:"12",label:"节期纲目篇题",title:"feasts_title"}]},{key:"sub5",icon:()=>s(r),label:"主恢复的清明上河图",title:"map",children:[{key:"13",label:"上河图书名",title:"pano_book"},{key:"14",label:"上河图篇题",title:"pano_title"}]},{key:"15",icon:()=>s(r),label:"诗歌",title:"hym"}]),u=i([]),E=()=>{window.history.back()},F=M(()=>{let a;return f.value[0]=="1"?a=[{title:"出处",dataIndex:"source",sorter:(e,d)=>e.sn-d.sn,defaultSortOrder:"ascend",width:"120px"},{title:"经文",dataIndex:"text"}]:a=[{title:"题目",dataIndex:"text",sorter:(e,d)=>e.sn-d.sn,defaultSortOrder:"ascend"},{title:"出处",dataIndex:"source",width:"50%"},{title:"查看",dataIndex:"lab",align:"center",width:"100px"}],a}),I=a=>{u.value=[],h.value=!0;let t=w.value,e=g.value,d=f.value[0];if(e=e.trim(),e)L.value=e.split(/ +/g);else{h.value=!1;return}let y=localStorage.getItem("token")||null;U.defaults.headers.common.Authorization=`Bearer ${y}`;let p=new FormData;p.append("input",e),p.append("fwds",t||" "),p.append("index",d),U.post("/api/map",p).then(C=>{let _=C.data;u.value=_,K.value=_.length,h.value=!1})};function P(a,t,e,d){}const T=M(()=>({pageSizeOptions:["10","20","30","40","50"],showTotal:a=>`共 ${a} 条`})),j=(a,t)=>{var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download",a),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},H=M(()=>u.value.length==0),J=()=>{let a=[];for(let t=0;t<u.value.length;t++){let e=u.value[t];e.text=e.text.replace(/<[^>]+>/g,""),a.push(e)}return a},X=()=>{let a=B.value+".json",t=JSON.stringify(J(),null,2);j(a,t)},q=a=>{B.value=a.item.originItemValue.label,I()},G=a=>{N.value=a,R.value=!0};return(a,t)=>{const e=ve,d=me,y=ie,p=be,C=fe,_=he,Q=ye,W=re,Y=de;return m($)?(v(),x("div",ke,[l("div",ge,[l("div",{onClick:E,class:"back"},[o(m(ce))]),we]),o(e,{style:{margin:"10px 0"}}),o(Y,{wrap:!1},{default:c(()=>[o(y,{flex:"250px"},{default:c(()=>[l("div",null,[o(d,{openKeys:O.value,"onUpdate:openKeys":t[0]||(t[0]=n=>O.value=n),selectedKeys:f.value,"onUpdate:selectedKeys":t[1]||(t[1]=n=>f.value=n),style:{width:"240px"},mode:"inline",items:z.value,forceSubMenuRender:!0,onSelect:q},null,8,["openKeys","selectedKeys","items"]),Ie])]),_:1}),o(y,{flex:"auto",class:"res"},{default:c(()=>[l("div",Ce,[l("div",Se,[l("div",Me,[o(p,{value:g.value,"onUpdate:value":t[2]||(t[2]=n=>g.value=n),placeholder:"请输入搜索词，多词以空格隔开","enter-button":"",onSearch:I},{prefix:c(()=>[o(m(ue))]),_:1},8,["value"]),Oe,o(C,{value:w.value,"onUpdate:value":t[3]||(t[3]=n=>w.value=n),placeholder:"请输入过滤词，多词以空格隔开",onPressEnter:I},{prefix:c(()=>[o(m(pe))]),_:1},8,["value"])])]),o(e,{style:{margin:"10px 0"}}),l("div",Be,[o(_,{type:"primary",onClick:X,disabled:H.value,icon:s(m(_e))},{default:c(()=>[V("下载结果 (共 "+A(K.value)+" 条)",1)]),_:1},8,["disabled","icon"])]),h.value?(v(),x("div",Ke,[o(Q,{tip:"加载中……",size:"large"})])):(v(),x("div",Te,[o(W,{columns:F.value,"data-source":u.value,pagination:T.value,"onUpdate:pagination":t[4]||(t[4]=n=>T.value=n),onChange:P,bordered:""},{bodyCell:c(({column:n,record:S})=>[n.dataIndex==="text"?(v(),x("div",{key:0,innerHTML:S[n.dataIndex]},null,8,Ue)):n.dataIndex==="lab"?(v(),te(_,{key:1,onClick:De=>G(S.msg)},{default:c(()=>[V(A(S[n.dataIndex]),1)]),_:2},1032,["onClick"])):D("",!0)]),_:1},8,["columns","data-source","pagination"])]))])]),_:1})]),_:1}),Ve,o(se)])):D("",!0)}}}),Ye=xe(Ae,[["__scopeId","data-v-d84bcfc8"]]);export{Ye as default};
